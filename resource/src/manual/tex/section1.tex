\section{فرآیند پرداخت الکترونیکی}
\label{بخش:مقدمه}

فرآیندهای پرداخت الکترونیکی به کمک سامانه‌های
واسط (مثل زرین‌پال) روال کار مشابهی دارند.
مراحل پرداخت به کمک این سامانه‌ها عبارتند از:
\begin{enumerate}
	\item ثبت درخواست پرداخت
	\item انتقال کاربر به درگاه
	\item تکمیل پرداخت
\end{enumerate}
که شرح این مراحل در ادامه آمده است.

\subsection{ثبت پرداخت}
اولین مرحله در شروع یک فرآیند پرداخت، ثبت اطلاعات
آن در سامانهٔ واسط است. اصلی‌ترین بخش این اطلاعات
معمولاً شامل مشخصات سامانهٔ گیرنده، مبلغ و شرح تراکنش
(برای مثال «خرید کالا» یا «کمک مالی») است. 
ممکن است مشخصات بیشتری از پرداخت کننده مثل
نام، نشانی ایمیل، شمارهٔ تلفن و غیره در فهرست اطلاعات
مورد نیاز وجود داشته باشند.

علاوه بر این موارد، لازم است
نشانی مسیر بازگشت کاربر انسانی نیز
در زمان ثبت درخواست پرداخت تعیین شود
تا سامانهٔ واسط پس از پایان عملیات پرداخت کاربر انسانی
را به آن نشانی هدایت کند. هرچند محدودیت خاصی بر روی
نشانی مذکور وجود
ندارد\پانوشت{در بخش~\رجوع{بخش:کاربرد} از این 
خاصیت برای آزمودن برنامه در محیط محلی
استفاده خواهیم کرد.}
اما در عمل این نشانی به یکی از منابع
سامانهٔ گیرنده اشاره می‌کند.

سامانهٔ گیرنده باید ابتدا اطلاعات گفته شده را در سامانهٔ
واسط ثبت کند. در پاسخ به ثبت اطلاعات، سامانهٔ واسط
رمزینهٔ یکتایی را تولید کرده و به فراخواننده بازمی‌گرداند.
از این پس، پرداخت مورد نظر تنها با این رمزینه در نزد
سامانهٔ واسط شناسایی خواهد شد.

\subsection{انتقال کاربر به درگاه}
پس از ثبت نام و دریافت رمزینهٔ پرداخت، کاربر انسانی
بایستی به درگاه پرداخت منتقل شود. معمولاً نشانی
منبعی که کاربر باید به آن رجوع کند حاوی رمزینهٔ
پرداخت نیز می‌باشد. به این ترتیب هنگام رجوع کاربر،
سامانهٔ واسط، پرداخت مورد نظر را که قبلاً اطلاعات آن ثبت
شده شناسایی کرده و کاربر را بر اساس آن به درگاه
پرداخت بانک هدایت می‌کند.

\subsection{تکمیل پرداخت}
هنگامی که تراکنش بانکی با موفقیت (یا عدم موفقیت) به
اتمام برسد سامانهٔ واسط، کاربر انسانی را به نشانی
مسیر بازگشت تعیین شده در زمان ثبت پرداخت هدایت
می‌کند. چنانچه گفته شد مسیر بازگشت در واقع یکی از
منابع سامانهٔ گیرنده است که بررسی نتیجهٔ عملیات پرداخت
در آن صورت می‌گیرد. به عبارت دقیق‌تر در این مرحله
سامانهٔ گیرنده اطلاعات پرداخت را مجدداً به سامانهٔ واسط
ارسال، نتیجهٔ عملیات را دریافت کرده و به کاربر انسانی
اطلاع می‌دهد.


